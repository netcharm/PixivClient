<Controls:MetroWindow x:Class="PixivWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:Controls="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
        xmlns:local="clr-namespace:PixivWPF"
        mc:Ignorable="d"
        Icon="pack://application:,,,/PixivWPF;component/Resources/pixiv-icon.ico"
        Title="Pixiv" 
        BorderBrush="{DynamicResource AccentColorBrush}"
        GlowBrush="{DynamicResource AccentColorBrush}"
        BorderThickness="1"
        WindowStartupLocation="CenterScreen" MinWidth="800" MinHeight="600"
        Closing="MainWindow_Closing">


    <Controls:MetroWindow.Resources>
        <Style x:Key="MetroSplitButton" TargetType="{x:Type Controls:SplitButton}">
            <Setter Property="Background" Value="Transparent" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="{DynamicResource AccentColorBrush}" />
                    <Setter Property="BorderThickness" Value="1" />
                </Trigger>
            </Style.Triggers>
        </Style>

    </Controls:MetroWindow.Resources>
    
    <Controls:MetroWindow.Flyouts>
        <Controls:FlyoutsControl>

        </Controls:FlyoutsControl>
    </Controls:MetroWindow.Flyouts>

    <Controls:MetroWindow.WindowButtonCommands>
        <Controls:WindowButtonCommands Style="{DynamicResource MahApps.Metro.Styles.WindowButtonCommands.Win10}" />
    </Controls:MetroWindow.WindowButtonCommands>

    <Controls:MetroWindow.LeftWindowCommands>
        <Controls:WindowCommands ShowLastSeparator="True">
            <Button Click="CommandNav_Click"
                    ToolTip="Open Navigation Flyout">
                <Rectangle Width="16" Height="16" Fill="{DynamicResource IdealForegroundColorBrush}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill" Visual="{DynamicResource appbar_page_search}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <Button Click="CommandNavRefresh_Click"
                    ToolTip="Refresh Current Page">
                <Rectangle Width="16" Height="16" Fill="{DynamicResource IdealForegroundColorBrush}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill" Visual="{DynamicResource appbar_refresh}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <Button Click="CommandNavPrev_Click"
                    ToolTip="Goto Prev Page" Visibility="Collapsed">
                <Rectangle Width="16" Height="16" Fill="{DynamicResource IdealForegroundColorBrush}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill" Visual="{DynamicResource appbar_navigate_previous}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <Button Click="CommandNavNext_Click"
                    ToolTip="Goto Next Page">
                <Rectangle Width="16" Height="16" Fill="{DynamicResource IdealForegroundColorBrush}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill" Visual="{DynamicResource appbar_navigate_next}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <TextBlock x:Name="NavPageTitle" x:Uid="NavPageTitle" 
                       HorizontalAlignment="Left" VerticalAlignment="Center"
                       Foreground="{DynamicResource IdealForegroundColorBrush}"/>
        </Controls:WindowCommands>
    </Controls:MetroWindow.LeftWindowCommands>

    <Controls:MetroWindow.RightWindowCommands>
        <Controls:WindowCommands ShowLastSeparator="False">
            <Button Click="CommandLogin_Click"
                    ToolTip="Open Login Dialog">
                <iconPacks:PackIconModern Kind="User" />
                <!--<Rectangle Width="16" Height="16" Fill="{DynamicResource IdealForegroundColorBrush}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill" Visual="{DynamicResource appbar_user}"/>
                    </Rectangle.OpacityMask>
                </Rectangle>-->
            </Button>
            <Button Click="CommandToggleTheme_Click" >
                <iconPacks:PackIconModern Kind="Contrast" />
            </Button>
            <Controls:SplitButton x:Name="CommandToggleTheme"
                                  ToolTip="Toggle Application Theme"
                                  Background="Transparent"
                                  AlternationCount="2"
                                  BorderBrush="{DynamicResource AccentColorBrush}"
                                  Click="CommandToggleTheme_Click" SelectionChanged="CommandToggleTheme_SelectionChanged">

                              <!--ArrowBrush="{DynamicResource IdealForegroundDisabledBrush}"
                                  Foreground="{DynamicResource IdealForegroundDisabledBrush}"
                                  Background="Transparent" 
                                  Style="{DynamicResource MetroSplitButton}"
                                  BorderThickness="1" BorderBrush="{Binding Path=WindowTitleBrush, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Controls:MetroWindow}}}"-->

                <Controls:SplitButton.Icon>
                    <iconPacks:PackIconModern Kind="ClothesShirt" />
                </Controls:SplitButton.Icon>
            </Controls:SplitButton>
        </Controls:WindowCommands>
    </Controls:MetroWindow.RightWindowCommands>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Frame Grid.Column="0" x:Name="NavFrame" NavigationUIVisibility="Visible">
            <Frame.CacheMode>
                <BitmapCache EnableClearType="True" SnapsToDevicePixels="True"/>
            </Frame.CacheMode>
        </Frame>
        <Frame Grid.Column="1" x:Name="ContentFrame">
            <Frame.CacheMode>
                <BitmapCache EnableClearType="True" SnapsToDevicePixels="True"/>
            </Frame.CacheMode>
        </Frame>
        <Controls:Flyout Grid.Column="0" Grid.ColumnSpan="2" 
                         x:Name="NavFlyout" x:Uid="NavFlyout" Header="Navigation" 
                         Position="Left" Width="Auto" 
                         IsAutoCloseEnabled="True" AutoCloseInterval="10000"
                         CloseButtonVisibility="Visible" ExternalCloseButton="Left"
                         Theme="Accent" Opacity="0.95"
                         Foreground="{DynamicResource LabelTextBrush}" Background="{DynamicResource WhiteColorBrush}" DataContextChanged="NavFlyout_DataContextChanged">
            <!-- Your custom content here -->
            
        </Controls:Flyout>
    </Grid>
</Controls:MetroWindow>
